Đây là lỗi **phía integration với `@near-wallet-selector/meteor-wallet`** (trong bộ Wallet Selector của NEAR), báo:
`Cannot read properties of undefined (reading 'signer')`

### **Nguyên nhân phổ biến nhất:**

* **Phiên bản wallet selector hoặc meteor-wallet không tương thích với phiên bản extension ví Meteor.**
* **Config thiếu tham số**, hoặc **wallet chưa sẵn sàng** lúc gọi `getAccounts()`.
* **Quy trình khởi tạo wallet-selector** bị thiếu bước hoặc config sai.

---

## **Cách xử lý thực chiến**

### **1. Đảm bảo đúng phiên bản các package**

* **Chỉ dùng các package wallet-selector và các plugin cùng version hoặc recommend trong docs.**
* Nên dùng các phiên bản mới nhất (hoặc phiên bản `@near-wallet-selector/core`, `@near-wallet-selector/meteor-wallet` khớp nhau).
* Nếu dùng `npm` thì nên cài từng package kèm flag:

  ```sh
  npm install @near-wallet-selector/core @near-wallet-selector/meteor-wallet @near-wallet-selector/modal-ui --legacy-peer-deps
  ```

---

### **2. Kiểm tra lại config khởi tạo Wallet Selector**

* Bạn cần đảm bảo đã **import và khởi tạo đúng Meteor Wallet** trong config.
* Một ví dụ chuẩn (TypeScript/JS, chỉnh lại cho Vue):

  ```js
  import { setupWalletSelector } from "@near-wallet-selector/core";
  import { setupMeteorWallet } from "@near-wallet-selector/meteor-wallet";
  import { setupModal } from "@near-wallet-selector/modal-ui";

  async function initSelector() {
    const selector = await setupWalletSelector({
      network: "testnet",
      modules: [setupMeteorWallet()],
    });

    const modal = setupModal(selector, { /* options */ });
    return { selector, modal };
  }
  ```
* **Chú ý**: Nếu bạn custom config hoặc module chưa đúng, biến `signer` sẽ không được inject vào selector context.

---

### **3. Kiểm tra code gọi connect**

* Sau khi user click "Kết nối ví", bạn cần gọi đúng flow:

  * Mở modal → chọn Meteor Wallet → thực hiện connect.
* Đảm bảo **selector** được khởi tạo trước khi gọi connect.

---

### **4. Xử lý fallback**

* Nếu Meteor Wallet extension chưa cài hoặc chưa unlock, selector có thể trả về undefined, cần handle kỹ trong FE.

---

### **5. Đề xuất debug**

* **Log lại giá trị trả về từ selector & wallet context**:

  ```js
  console.log('Selector:', selector);
  console.log('Wallet:', wallet); // Xem wallet nào là active, có chứa signer không
  ```
* Nếu `wallet.signer` undefined, tức là **module meteor-wallet chưa khởi tạo đúng hoặc chưa hoàn thành handshake**.

---

### **6. Đảm bảo extension Meteor Wallet là phiên bản mới nhất**

* Một số extension cũ chưa support toàn bộ Wallet Selector.
* Update Meteor Wallet extension trên browser.

---

## **Nguồn tham khảo**

* [NEAR Wallet Selector Docs](https://near.github.io/wallet-selector/)
* [Mã mẫu dùng Meteor Wallet + Modal UI](https://github.com/near/wallet-selector/blob/main/packages/example/src/main.js)

---

## **Tóm tắt hướng sửa**

* **Check lại version các package** (core, modal-ui, meteor-wallet phải cùng major version).
* **Check lại config setupWalletSelector** – phải đúng modules và đúng network.
* **Đảm bảo extension Meteor Wallet cập nhật mới nhất**.
* **Log kỹ context**: Nếu signer undefined, chứng tỏ wallet selector hoặc module bị lỗi.

---

**Nếu sau khi check lại các bước trên vẫn gặp lỗi, bạn gửi file cấu hình wallet-selector, và/hoặc snippet code connect wallet của bạn.
Mình sẽ đọc code & chỉ đúng dòng cần sửa.**

Bạn đã đi rất gần thành công rồi, chỉ cần đồng bộ đúng package và config là connect được ví!
